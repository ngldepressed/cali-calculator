<!DOCTYPE html>
<html>
<head>
  <title>Cali-Biotech: Baseline Command</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    :root { --primary: #4c6fff; --potential: #00ffcc; --bg: #0b0b12; --card: #161621; --border: #2a2a3a; --danger: #ff4c4c; --text: #e0e0e0; --warning: #ffcc00; }
    body { font-family: 'Inter', sans-serif; background: var(--bg); color: var(--text); display:flex; flex-direction:column; align-items:center; padding:10px; margin:0; }
    .container { background:var(--card); padding:20px; border-radius:24px; width:100%; max-width:1300px; border: 1px solid var(--border); box-sizing: border-box; }
    .main-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 15px; width:100%; }
    .card { background: #1f1f2e; padding: 18px; border-radius: 16px; border: 1px solid #333; }
    .card h3 { margin-top: 0; color: var(--primary); font-size: 0.75em; text-transform: uppercase; margin-bottom: 12px; border-bottom: 1px solid #333; padding-bottom: 5px; }
    label { display:block; margin-top:8px; font-size: 0.65em; color: #888; text-transform: uppercase; font-weight: bold;}
    input, select { width:100%; padding:10px; margin-top:4px; border-radius:8px; border:1px solid #333; background:var(--bg); color:white; font-size: 0.85em; box-sizing: border-box; }
    .inline-quad { display: grid; grid-template-columns: 1.2fr 0.8fr 0.8fr 1fr; gap: 5px; }
    .dashboard-row { display: grid; grid-template-columns: 1.2fr 1fr 1fr; gap: 20px; margin-top: 30px; width:100%; }
    .analysis-panel { background:#1f1f2e; padding:20px; border-radius:20px; border: 1px solid #333; min-height: 400px; }
    .skill-bar-container { margin-bottom: 12px; }
    .skill-label { display: flex; justify-content: space-between; font-size: 0.75em; margin-bottom: 4px; font-weight: bold; }
    .bar-bg { background: #0b0b12; height: 8px; border-radius: 4px; overflow: hidden; }
    .bar-fill { height: 100%; background: linear-gradient(90deg, var(--primary), var(--potential)); transition: width 0.5s ease; }
    .col-header { font-size: 0.5em; color: var(--primary); text-align: center; }
    .session-guide { padding: 10px; border-radius: 8px; margin-top: 10px; font-size: 0.75em; font-weight: bold; text-align: center; border: 1px solid #444; }
    @media (max-width: 1000px) { .dashboard-row { grid-template-columns: 1fr; } }
  </style>
</head>
<body onload="loadSavedData(); analyze();">

<div class="container">
    <h1 style="text-align:center; color:var(--primary); font-size:1.4em; letter-spacing:4px;">CALI-BIOTECH COMMAND</h1>

    <div class="main-grid">
        <div class="card">
            <h3>Structure</h3>
            <label>Weight (kg)</label><input type="number" id="weight" value="75" oninput="analyze(); saveToLocal();">
            <label>Height (cm)</label><input type="number" id="hCm" value="175" oninput="analyze(); saveToLocal();">
            <label>CNS Readiness</label>
            <input type="range" id="cns" min="1" max="10" value="9" oninput="analyze(); saveToLocal();">
            <div id="sessionType" class="session-guide"></div>
        </div>

        <div class="card">
            <h3>BW Basics</h3>
            <div class="inline-quad" style="grid-template-columns: 1fr 1fr;">
                <div><label>Pullups</label><input type="number" id="pullups" value="15" oninput="analyze(); saveToLocal();"></div>
                <div><label>Pushups</label><input type="number" id="pushups" value="35" oninput="analyze(); saveToLocal();"></div>
            </div>
            <div class="inline-quad" style="grid-template-columns: 1fr 1fr;">
                <div><label>Muscle-Ups</label><input type="number" id="mu" value="5" oninput="analyze(); saveToLocal();"></div>
                <div><label>Dead Hang (s)</label><input type="number" id="hang" value="60" oninput="analyze(); saveToLocal();"></div>
            </div>
            <label>Leg Inertia</label>
            <select id="legRatio" onchange="analyze(); saveToLocal();"><option value="0.95">Short</option><option value="1.0" selected>Neutral</option><option value="1.1">Long/Heavy</option></select>
        </div>

        <div class="card">
            <h3>Weighted Matrix</h3>
            <div class="inline-quad"><div class="col-header">Weight</div><div class="col-header">Reps</div><div class="col-header">Sets</div><div class="col-header">RPE</div></div>
            <label>Weighted Pull-up</label>
            <div class="inline-quad"><input type="number" id="wpW" value="25" oninput="analyze(); saveToLocal();"><input type="number" id="wpR" value="5" oninput="analyze(); saveToLocal();"><input type="number" id="wpS" value="3" oninput="analyze(); saveToLocal();"><input type="number" id="wpRPE" value="8" oninput="analyze(); saveToLocal();"></div>
            <label>Weighted Dip</label>
            <div class="inline-quad"><input type="number" id="wdW" value="35" oninput="analyze(); saveToLocal();"><input type="number" id="wdR" value="5" oninput="analyze(); saveToLocal();"><input type="number" id="wdS" value="3" oninput="analyze(); saveToLocal();"><input type="number" id="wdRPE" value="8" oninput="analyze(); saveToLocal();"></div>
            <label>Zanetti Raise (SA)</label>
            <div class="inline-quad"><input type="number" id="saW" value="12" oninput="analyze(); saveToLocal();"><input type="number" id="saR" value="8" oninput="analyze(); saveToLocal();"><input type="number" id="saS" value="3" oninput="analyze(); saveToLocal();"><input type="number" id="saRPE" value="9" oninput="analyze(); saveToLocal();"></div>
        </div>
    </div>

    <div class="dashboard-row">
        <div style="background:var(--bg); border-radius:20px; padding:10px; border:1px solid var(--border); display: flex; align-items:center;"><canvas id="skillRadar"></canvas></div>
        <div class="analysis-panel" id="skillBars"></div>
        <div class="analysis-panel" id="aiFeedback"></div>
    </div>
</div>

<script>
let radarChart;
const skills = [
    { name: "Full Planche", p: 3.4, l: 0, s: 2.5 },
    { name: "Straddle Planche", p: 2.8, l: 0, s: 2.0 },
    { name: "Front Lever", p: 0, l: 2.6, s: 1.8 },
    { name: "Iron Cross", p: 0, l: 3.0, s: 4.0 }
];

function analyze() {
    if(!radarChart) initChart();
    let bw = parseFloat(document.getElementById("weight").value) || 75;
    let h = parseFloat(document.getElementById("hCm").value) || 175;
    let cnsVal = parseInt(document.getElementById("cns").value);
    
    const get1RM = (idW, idR, idRPE) => (bw + (parseFloat(document.getElementById(idW).value)||0) * (1 + (parseInt(document.getElementById(idR).value)||0)/30) * (1+(10-parseInt(document.getElementById(idRPE).value))/18)) / bw;
    
    const pullRatio = get1RM("wpW", "wpR", "wpRPE");
    const pushRatio = get1RM("wdW", "wdR", "wdRPE");
    const saRatio = get1RM("saW", "saR", "saRPE");
    const torque = Math.pow(h / 170, 2.3) * parseFloat(document.getElementById("legRatio").value);

    // Session Guide Logic
    const sessionBox = document.getElementById("sessionType");
    if (cnsVal >= 8) { sessionBox.innerText = "S-TIER: PEAK SKILL / MAX EFFORT"; sessionBox.style.color = "var(--potential)"; sessionBox.style.borderColor = "var(--potential)"; }
    else if (cnsVal >= 5) { sessionBox.innerText = "A-TIER: TECHNICAL VOLUME (75%)"; sessionBox.style.color = "var(--warning)"; sessionBox.style.borderColor = "var(--warning)"; }
    else { sessionBox.innerText = "RECOVERY: ISOLATION & MOBILITY"; sessionBox.style.color = "var(--danger)"; sessionBox.style.borderColor = "var(--danger)"; }

    // Audit
    const integrity = (saRatio / pushRatio) * 100;
    document.getElementById("aiFeedback").innerHTML = `<h3>Audit</h3>
        <p><b>Torque:</b> ${torque.toFixed(2)}x</p>
        <p><b>SA Integrity:</b> <span style="color:${integrity < 60 ? 'var(--danger)' : 'var(--potential)'}">${integrity.toFixed(0)}%</span></p>
        <p style="font-size:0.7em;">${integrity < 60 ? "Warning: Connective tissue lagging. Focus on Straight Arm strength." : "Ready for isometric loading."}</p>`;

    // Bars
    let barHtml = "<h3>Skill Status</h3>";
    const scores = skills.map(s => {
        let sc = [];
        if (s.p > 0) sc.push((pushRatio / (s.p * torque)) * 100);
        if (s.l > 0) sc.push((pullRatio / (s.l * torque)) * 100);
        if (s.s > 0) sc.push((saRatio / (s.s * torque)) * 100);
        let cur = Math.min(100, Math.min(...sc) * (cnsVal/10));
        barHtml += `<div class="skill-bar-container"><div class="skill-label"><span>${s.name}</span><span>${cur.toFixed(0)}%</span></div><div class="bar-bg"><div class="bar-fill" style="width:${cur}%"></div></div></div>`;
        return cur;
    });
    document.getElementById("skillBars").innerHTML = barHtml;
    radarChart.data.datasets[0].data = scores;
    radarChart.update();
}

function initChart() {
    radarChart = new Chart(document.getElementById('skillRadar'), {
        type: 'radar',
        data: { labels: skills.map(s => s.name), datasets: [{ data: [], backgroundColor: 'rgba(76, 111, 255, 0.2)', borderColor: '#4c6fff' }] },
        options: { scales: { r: { beginAtZero: true, max: 100, ticks: { display: false }, grid: { color: '#333' } } }, plugins: { legend: { display: false } } }
    });
}

function saveToLocal() {
    const data = {};
    document.querySelectorAll('input, select').forEach(i => data[i.id] = i.value);
    localStorage.setItem('caliDataBaseline', JSON.stringify(data));
}

function loadSavedData() {
    const saved = JSON.parse(localStorage.getItem('caliDataBaseline'));
    if (saved) Object.keys(saved).forEach(id => { if(document.getElementById(id)) document.getElementById(id).value = saved[id]; });
}
</script>
</body>
</html>