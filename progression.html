<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CALI-BIOTECH | NEURAL ARCHITECTURE v2.0</title>
    <style>
        :root {
            --primary: #4c6fff;
            --bg: #0a0a0f;
            --surface: #161625;
            --accent: #00ff88;
            --warning: #ff4c4c;
            --text: #e6edf3;
            --glow: rgba(76, 111, 255, 0.2);
        }

        body {
            background: var(--bg);
            color: var(--text);
            font-family: 'Courier New', monospace;
            padding: 30px;
            line-height: 1.4;
        }

        .engine-container {
            max-width: 1000px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1.5fr;
            gap: 20px;
        }

        .sidebar, .main-view { display: flex; flex-direction: column; gap: 20px; }

        .card {
            background: var(--surface);
            padding: 20px;
            border-radius: 4px;
            border: 1px solid rgba(76, 111, 255, 0.15);
            box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }

        h1, h2, h3 {
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-top: 0;
            color: var(--primary);
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.85em;
            border-bottom: 1px solid rgba(255,255,255,0.05);
            padding-bottom: 5px;
        }

        .val { color: var(--accent); font-weight: bold; }

        input, select, button {
            width: 100%;
            background: #000;
            border: 1px solid var(--primary);
            color: var(--primary);
            padding: 12px;
            margin: 10px 0;
            font-family: monospace;
            text-transform: uppercase;
            font-weight: bold;
        }

        button {
            background: rgba(76, 111, 255, 0.1);
            cursor: pointer;
            transition: 0.3s;
        }

        button:hover {
            background: var(--primary);
            color: #000;
            box-shadow: 0 0 20px var(--glow);
        }

        .meter {
            height: 4px;
            background: #222;
            width: 100%;
            margin-top: 5px;
            overflow: hidden;
        }

        .meter-fill { height: 100%; background: var(--primary); transition: 1s; }

        .log-entry {
            font-size: 0.75em;
            padding: 8px;
            border-left: 2px solid var(--primary);
            background: rgba(255,255,255,0.02);
            margin-bottom: 5px;
        }

        .presc-block { border-left: 2px solid var(--accent); padding-left: 15px; margin-bottom: 20px; }
        .presc-title { color: var(--accent); font-size: 0.8em; margin-bottom: 5px; }
    </style>
</head>
<body>

    <header style="text-align: center; margin-bottom: 40px;">
        <h1>NEURAL ARCHITECTURE :: ADAPTIVE COACH</h1>
        <div style="font-size: 0.7em; opacity: 0.6;">BIOTEST SIMULATION ACTIVE // VERSION 2.0.4</div>
    </header>

    <div class="engine-container">
        
        <div class="sidebar">
            <div class="card">
                <h3>System Initialization</h3>
                <label class="small">PRIMARY OBJECTIVE</label>
                <select id="skillTarget">
                    <option value="planche">PLANCHE (STRAIGHT ARM PUSH)</option>
                    <option value="front_lever">FRONT LEVER (STRAIGHT ARM PULL)</option>
                    <option value="oac">ONE ARM CHIN (BENT ARM PULL)</option>
                    <option value="maltese">MALTESE (EXTREME LEVERAGE)</option>
                </select>

                <label class="small">DATA INPUTS</label>
                <input type="number" id="sleep" placeholder="SLEEP (HRS)">
                <input type="number" id="rpe" placeholder="PREV SESSION RPE (1-10)">
                <input type="number" id="hrv" placeholder="ESTIMATED HRV (1-100)">

                <button onclick="calculateMacrocycle()">EXECUTE BIOTEST</button>
            </div>

            <div id="status-card" class="card" style="display:none;">
                <h3>Neural Status</h3>
                <div id="stats-display"></div>
            </div>
        </div>

        <div class="main-view">
            <div id="output" class="card" style="min-height: 400px;">
                <h2 id="session-header">Waiting for initialization...</h2>
                <div id="session-content"></div>
            </div>
        </div>

    </div>

<script>
    // COMPLEX STATE ENGINE
    let state = {
        week: 1,
        cumulativeFatigue: 0,
        neuralLoad: 0,
        adaptationScore: 0,
        phase: "ANATOMICAL ADAPTATION"
    };

    const SkillHierarchy = {
        planche: [
            {id: "Planche Lean", intensity: 1, volume: 30},
            {id: "Tuck Planche", intensity: 2, volume: 20},
            {id: "Adv. Tuck", intensity: 3, volume: 15},
            {id: "Straddle Planche", intensity: 4, volume: 10},
            {id: "Full Planche", intensity: 5, volume: 8}
        ],
        // Additional skill arrays would go here
    };

    function calculateMacrocycle() {
        const sleep = parseFloat(document.getElementById('sleep').value) || 8;
        const rpe = parseFloat(document.getElementById('rpe').value) || 5;
        const hrv = parseFloat(document.getElementById('hrv').value) || 70;

        // 1. NEURAL FATIGUE MODELING (The Logic)
        let recoveryFactor = (sleep / 8) * (hrv / 100);
        state.neuralLoad = (rpe * 1.5) / recoveryFactor;
        state.cumulativeFatigue += (state.neuralLoad - 5);
        if(state.cumulativeFatigue < 0) state.cumulativeFatigue = 0;

        // 2. PERIODIZATION LOGIC
        const mesoCycle = Math.ceil(state.week / 4);
        const microCycle = state.week % 4; // 1,2,3 = Load, 0 = Deload
        
        let intensityScale = 0.7; // Base
        if(microCycle === 1) { intensityScale = 0.75; state.phase = "ACCUMULATION"; }
        if(microCycle === 2) { intensityScale = 0.85; state.phase = "INTENSIFICATION"; }
        if(microCycle === 3) { intensityScale = 0.95; state.phase = "PEAK OVERLOAD"; }
        if(microCycle === 0) { intensityScale = 0.60; state.phase = "STRATEGIC DELOAD"; }

        // 3. GENERATE COMPLEX SESSION
        generatePrescription(intensityScale, microCycle);
        updateUI();
        state.week++;
    }

    function generatePrescription(scale, micro) {
        const target = document.getElementById('skillTarget').value;
        const isDeload = micro === 0;

        let html = `<h3>CURRENT PHASE: ${state.phase}</h3>`;
        
        // Block 1: Neural Prep
        html += `<div class="presc-block">
                    <div class="presc-title">BLOCK A: NEURAL PRIMING (WARMUP)</div>
                    • Scapular Depressions: 3 x 12 (Focus on max depression)<br>
                    • Wrist Load Cycles: 5 Minutes (Radial/Ulnar focus)<br>
                    • Hollow Body Rockers: 3 x 45s
                 </div>`;

        // Block 2: Primary Lever (The Complex Part)
        let sets = isDeload ? 2 : (micro === 3 ? 5 : 3);
        let holdTime = Math.round(15 * (1/scale));
        
        html += `<div class="presc-block">
                    <div class="presc-title">BLOCK B: ISO-METRIC LEVERAGE</div>
                    • Primary Skill: ${target.toUpperCase()} PROGRESSION<br>
                    • Volume: ${sets} Sets<br>
                    • Intensity: ${Math.round(scale * 100)}% of Max Hold<br>
                    • Hold Time: ${holdTime}s Per Set<br>
                    • Rest Interval: ${isDeload ? '90s' : '180s-240s'}
                 </div>`;

        // Block 3: Dynamic Accessory
        html += `<div class="presc-block">
                    <div class="presc-title">BLOCK C: STRUCTURAL INTEGRITY</div>
                    • Zanetti Press: 3 x 8 (Lightweight/High Form)<br>
                    • Pseudo Pushups: 3 x ${isDeload ? 5 : 10} (Lean: Max)<br>
                    • Face Pulls: 4 x 15 (External Rotation Focus)
                 </div>`;

        // Block 4: Coach Logic
        let alertColor = state.cumulativeFatigue > 15 ? 'var(--warning)' : 'var(--accent)';
        html += `<div class="log-entry" style="border-color: ${alertColor}">
                    <strong>ENGINE ANALYSIS:</strong><br>
                    ${state.cumulativeFatigue > 15 ? 
                    'CRITICAL FATIGUE DETECTED. AUTO-REGULATING VOLUME BY -25%.' : 
                    'HOMEOSTASIS STABLE. PROCEED WITH PLANNED OVERLOAD.'}
                    Focus on straight-arm elbow locking to prevent bicep tendon shear.
                 </div>`;

        document.getElementById('session-content').innerHTML = html;
        document.getElementById('session-header').innerText = `SESSION LOG: WEEK ${state.week}`;
    }

    function updateUI() {
        document.getElementById('status-card').style.display = 'block';
        let risk = state.cumulativeFatigue > 20 ? "CRITICAL" : (state.cumulativeFatigue > 10 ? "ELEVATED" : "OPTIMAL");
        
        document.getElementById('stats-display').innerHTML = `
            <div class="stat-row"><span>WEEK</span> <span class="val">${state.week}</span></div>
            <div class="stat-row"><span>NEURAL LOAD</span> <span class="val">${state.neuralLoad.toFixed(1)}</span></div>
            <div class="stat-row"><span>FATIGUE DEBT</span> <span class="val">${state.cumulativeFatigue.toFixed(1)}</span></div>
            <div class="stat-row"><span>INJURY RISK</span> <span class="val" style="color:${risk==='CRITICAL'?'#ff4c4c':''}">${risk}</span></div>
            <div class="meter"><div class="meter-fill" style="width:${Math.min(state.cumulativeFatigue * 5, 100)}%"></div></div>
        `;
    }
</script>
</body>
</html>